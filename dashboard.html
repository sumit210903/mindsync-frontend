<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MindSync - Wellness Synergy Dashboard</title>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    /* (KEEPING ALL YOUR STYLES â€” unchanged) */
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Quicksand',sans-serif; }
    body {
      background: linear-gradient(135deg, #dff6f0, #b9e5e8, #a7c7e7);
      color: #2c3e50;
      min-height: 100vh;
    }
    nav {
      background: rgba(255,255,255,0.95);
      padding: 12px 6%;
      display:flex;
      justify-content:space-between;
      align-items:center;
      position:sticky;
      top:0;
      z-index:1000;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      gap: 12px;
      flex-wrap:wrap;
    }
    nav h1 { font-size:22px; font-weight:700; color:#006c59; display:flex; align-items:center; gap:8px;}
    nav h1 i { color:#006c59; font-size:26px; animation:pulse 2s infinite; }
    nav .nav-right { display:flex; align-items:center; gap:12px; }
    nav ul { list-style:none; display:flex; gap:18px; align-items:center; }
    nav ul li a { text-decoration:none; color:#2c3e50; font-size:15px; font-weight:600; display:flex; gap:8px; align-items:center; padding:8px 10px; border-radius:8px;}
    nav ul li a.active, nav ul li a:hover { color:#fff; background:#006c59; transform:translateY(-1px); }
    @keyframes pulse { 0%,100% { transform:scale(1);} 50% { transform:scale(1.15);} }
    .container { padding: 28px 6%; max-width:1200px; margin:0 auto; }
    .top-row { display:flex; gap:20px; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-bottom:18px; }
    .profile-card {
      background:#fff; border-radius:14px; padding:12px 16px; box-shadow:0 8px 18px rgba(0,0,0,0.06);
      display:flex; gap:12px; align-items:center;
    }
    .profile-avatar { width:56px; height:56px; border-radius:50%; background:#e6f6f0; display:flex; align-items:center; justify-content:center; font-weight:700; color:#006c59; font-size:22px; overflow:hidden; }
    .profile-info { display:flex; flex-direction:column; }
    .profile-info small { color:#666; font-size:12px; }
    .grid { display:grid; grid-template-columns: 1fr 2fr; gap:18px; align-items:start; }
    .col { background:#fff; border-radius:14px; padding:16px; box-shadow:0 8px 18px rgba(0,0,0,0.06); }
    .col h2 { color:#006c59; margin-bottom:8px; font-size:18px; }
    .tiles { display:flex; gap:12px; margin-top:8px; flex-wrap:wrap; }
    .tile { flex:1; min-width:120px; background:#f8fffb; border-radius:10px; padding:12px; text-align:center; }
    .tile strong { display:block; font-size:18px; margin-top:6px; }
    .charts { display:grid; grid-template-columns:1fr 1fr; gap:14px; margin-top:14px; }
    .chart-box { height:260px; padding:10px; }
    form.inline { display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-top:10px; }
    form.inline input, form.inline select { padding:8px; border-radius:8px; border:1px solid #e2e8f0; min-width:120px; }
    button.btn { background:#006c59; color:#fff; padding:8px 12px; border-radius:10px; border:none; cursor:pointer; font-weight:600; }
    button.btn.secondary { background:#fff; color:#006c59; border:1px solid #006c59; }
    .section { display:none; margin-top:14px; }
    .section.active { display:block; }
    footer { background:#006c59; color:#fff; text-align:center; padding:18px 8px; margin-top:26px; border-radius:10px; }
    @media (max-width: 900px) { .grid { grid-template-columns: 1fr; } .charts { grid-template-columns: 1fr; } nav ul { display:none; } .menu-toggle { display:block; } }
    .menu-toggle { display:none; cursor:pointer; font-size:22px; color:#006c59; }
    .muted { color:#666; font-size:13px; }
    table { width:100%; border-collapse:collapse; font-size:13px; }
    table th, table td { padding:8px 6px; text-align:left; border-bottom:1px solid #f1f5f9; }
    .controls { display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; align-items:center; }
    .goal-progress { margin-top:8px; width:100%; height:10px; background:#eef9f6; border-radius:99px; overflow:hidden; }
    .goal-fill { height:100%; background:linear-gradient(90deg,#00c6a7,#006c59); width:0%; }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav>
    <h1><i class="fa-solid fa-brain"></i> MindSync</h1>

    <div class="nav-right">
      <div class="menu-toggle" id="menuToggle"><i class="fa-solid fa-bars"></i></div>
     <ul>
      <li><a href="dashboard.html"><i class="fa-solid fa-house"></i> Dashboard</a></li>
      <li><a href="wellness.html"><i class="fa-solid fa-chart-line"></i> Wellness</a></li>
      <li><a href="fitness.html"><i class="fa-solid fa-dumbbell"></i> Fitness</a></li>
      <li><a href="nutrition.html"><i class="fa-solid fa-utensils"></i> Nutrition</a></li>
      <li><a href="profile.html"><i class="fa-solid fa-user"></i> Profile</a></li>
      <li><a href="logout.html"><i class="fa-solid fa-right-from-bracket"></i> Logout</a></li>
    </ul>
    </div>
  </nav>

  <div class="container">
    <!-- Top Row: profile + quick actions -->
    <div class="top-row">
      <div class="profile-card">
        <div class="profile-avatar" id="avatarEl">U</div>
        <div class="profile-info">
          <strong id="profileName">User</strong>
          <small id="profileEmail" class="muted">local demo â€¢ data stored in browser</small>
        </div>
        <div style="margin-left:12px;">
          <button class="btn" id="quickAddBtn">Quick Add</button>
        </div>
      </div>

      <div class="profile-card" style="justify-content:flex-end; gap:14px;">
        <div style="text-align:right;">
          <div class="muted">Today's date</div>
          <strong id="todayDate"></strong>
        </div>
      </div>
    </div>

    <!-- Grid: left summary / right charts -->
    <div class="grid">
      <!-- Left column: summary + inputs -->
      <div class="col">
        <h2>Overview</h2>
        <div class="tiles">
          <div class="tile">
            <div class="muted">Avg Steps</div>
            <strong id="statAvgSteps">0</strong>
          </div>
          <div class="tile">
            <div class="muted">Avg Calories</div>
            <strong id="statAvgCalories">0</strong>
          </div>
          <div class="tile">
            <div class="muted">Avg Mood</div>
            <strong id="statAvgMood">0</strong>
          </div>
        </div>

        <div style="margin-top:12px;">
          <h3 style="color:#006c59; margin-bottom:8px;">Add Entry</h3>
          <form id="addEntryForm" class="inline" onsubmit="return false;">
            <select id="entryType">
              <option value="fitness">Fitness (steps)</option>
              <option value="nutrition">Nutrition (calories)</option>
              <option value="mental">Mental (mood 1-5)</option>
            </select>
            <input type="date" id="entryDate" required />
            <input type="number" id="entryValue" placeholder="Value" required />
            <input type="text" id="entryNote" placeholder="Note (optional)" />
            <button class="btn" id="entryAddBtn">Add</button>
            <button class="btn secondary" id="entryReset">Reset</button>
          </form>
        </div>

        <div style="margin-top:12px;">
          <h3 style="color:#006c59; margin-bottom:8px;">Goals</h3>
          <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
            <div>
              <div class="muted">Daily Steps</div>
              <input type="number" id="goalSteps" value="8000" style="padding:8px;border-radius:8px;border:1px solid #e2e8f0; min-width:100px;" />
            </div>
            <div>
              <div class="muted">Daily Calories</div>
              <input type="number" id="goalCalories" value="2000" style="padding:8px;border-radius:8px;border:1px solid #e2e8f0; min-width:100px;" />
            </div>
            <div>
              <div class="muted">Target Mood (1-5)</div>
              <input type="number" id="goalMood" value="4" min="1" max="5" style="padding:8px;border-radius:8px;border:1px solid #e2e8f0; width:80px;" />
            </div>
            <div>
              <button class="btn" id="saveGoals">Save Goals</button>
            </div>
          </div>
          <div style="margin-top:8px;">
            <div class="muted">Steps progress (today)</div>
            <div class="goal-progress"><div id="goalFillSteps" class="goal-fill"></div></div>
          </div>
        </div>

        <div style="margin-top:14px;">
          <h3 style="color:#006c59; margin-bottom:8px;">Recent Entries</h3>
          <table>
            <thead>
              <tr><th>Date</th><th>Tracker</th><th>Value</th></tr>
            </thead>
            <tbody id="recentEntries">
              <!-- auto filled -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Right column: charts & sections -->
      <div class="col">
        <!-- Dashboard charts (default) -->
        <div id="section-dashboard" class="section active">
          <h2>Visualizations</h2>
          <div class="charts">
            <div class="chart-box col" style="padding:10px;">
              <canvas id="stepsChart"></canvas>
            </div>
            <div class="chart-box col" style="padding:10px;">
              <canvas id="caloriesChart"></canvas>
            </div>
            <div class="chart-box col" style="padding:10px;">
              <canvas id="moodChart"></canvas>
            </div>
            <div class="chart-box col" style="padding:10px;">
              <canvas id="nutritionPie"></canvas>
            </div>
          </div>
        </div>

        <!-- Fitness section -->
        <div id="section-fitness" class="section">
          <h2>Fitness Tracker</h2>
          <p class="muted">Log steps and see trends. Set daily step goals and track completion.</p>
          <div style="margin-top:10px;">
            <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
              <input type="date" id="fitDate" />
              <input type="number" id="fitValue" placeholder="Steps" />
              <input type="text" id="fitNote" placeholder="Note (optional)" />
              <button class="btn" id="fitAdd">Add Steps</button>
              <button class="btn secondary" id="fitClear">Clear Fitness Data</button>
            </div>

            <div style="margin-top:12px;">
              <canvas id="fitnessOnlyChart" style="height:220px;"></canvas>
            </div>

            <div style="margin-top:12px;">
              <strong>Total Steps:</strong> <span id="totalSteps">0</span> &nbsp;&nbsp; <strong>Avg Steps:</strong> <span id="avgSteps">0</span>
            </div>
          </div>
        </div>

        <!-- Nutrition section -->
        <div id="section-nutrition" class="section">
          <h2>Nutrition Tracker</h2>
          <p class="muted">Log calories and track nutrition balance.</p>
          <div style="margin-top:10px;">
            <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
              <input type="date" id="nutDate" />
              <input type="number" id="nutValue" placeholder="Calories" />
              <select id="nutType">
                <option value="breakfast">Breakfast</option>
                <option value="lunch">Lunch</option>
                <option value="dinner">Dinner</option>
                <option value="snack">Snack</option>
              </select>
              <input type="text" id="nutNote" placeholder="Note" />
              <button class="btn" id="nutAdd">Add Meal</button>
              <button class="btn secondary" id="nutClear">Clear Nutrition Data</button>
            </div>

            <div style="margin-top:12px;">
              <canvas id="nutritionOnlyChart" style="height:220px;"></canvas>
            </div>

            <div style="margin-top:12px;">
              <strong>Total Calories:</strong> <span id="totalCalories">0</span> &nbsp;&nbsp; <strong>Avg Calories:</strong> <span id="avgCalories">0</span>
            </div>
          </div>
        </div>

        <!-- Mental section -->
        <div id="section-mental" class="section">
          <h2>Mental Health Tracker</h2>
          <p class="muted">Rate your mood (1 low â€” 5 high) and record notes.</p>
          <div style="margin-top:10px;">
            <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
              <input type="date" id="menDate" />
              <input type="number" id="menValue" placeholder="Mood 1-5" min="1" max="5" />
              <input type="text" id="menNote" placeholder="Note" />
              <button class="btn" id="menAdd">Add Mood</button>
              <button class="btn secondary" id="menClear">Clear Mental Data</button>
            </div>

            <div style="margin-top:12px;">
              <canvas id="mentalOnlyChart" style="height:220px;"></canvas>
            </div>

            <div style="margin-top:12px;">
              <strong>Avg Mood:</strong> <span id="avgMood">0</span>
            </div>

            <div style="margin-top:12px;">
              <h3 style="color:#006c59;">Recent Moods</h3>
              <ul id="recentMoods" style="list-style:none; padding-left:0;"></ul>
            </div>
          </div>
        </div>

        <!-- Profile section -->
        <div id="section-profile" class="section">
          <h2>Profile</h2>
          <p class="muted">Edit your name and avatar (URL). Data is stored locally for the demo.</p>
          <div style="margin-top:12px; display:flex; gap:12px; align-items:center; flex-wrap:wrap;">
            <div>
              <div class="profile-avatar" id="profileAvatarPreview" style="width:90px;height:90px;font-size:28px;">U</div>
            </div>
            <div style="flex:1; min-width:220px;">
              <label class="muted">Name</label>
              <input type="text" id="profName" style="width:100%; padding:8px; border-radius:8px; border:1px solid #e2e8f0;" />
              <label class="muted" style="margin-top:8px; display:block;">Avatar URL</label>
              <input type="text" id="profAvatar" style="width:100%; padding:8px; border-radius:8px; border:1px solid #e2e8f0;" />
              <div style="margin-top:8px;">
                <button class="btn" id="saveProfile">Save Profile</button>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <footer>
      <p>&copy; 2025 MindSync â€¢ Wellness Synergy â€” Dashboard prototype â€¢ Data stored locally (demo)</p>
    </footer>
  </div>

 <script>
  // ðŸ”’ Check Login Token First
  const token = localStorage.getItem('authToken');
  if (!token) {
    alert('Please login to access the dashboard.');
    window.location.href = 'login.html';  // redirect if not logged in
  }

  // --- Short helpers ---
  const qs = (s) => document.querySelector(s);
  const qsa = (s) => document.querySelectorAll(s);
  const TODAY = new Date().toISOString().slice(0, 10);

  // --- Initial App State ---
  const initialState = {
    profile: { name: 'User', avatar: '' },
    goals: { steps: 8000, calories: 2000, mood: 4 },
    fitness: [],
    nutrition: [],
    mental: [],
  };

  // --- Load / Save State ---
  function loadState() {
    try {
      const raw = localStorage.getItem('wellness_synergy_v1');
      return raw ? JSON.parse(raw) : JSON.parse(JSON.stringify(initialState));
    } catch (e) {
      console.error('load error', e);
      return JSON.parse(JSON.stringify(initialState));
    }
  }
  function saveState() {
    localStorage.setItem('wellness_synergy_v1', JSON.stringify(state));
  }

  let state = loadState();

  // --- Initialize DOM ---
  qs('#todayDate').textContent = new Date().toLocaleDateString();
  ['#entryDate', '#fitDate', '#nutDate', '#menDate'].forEach(id => qs(id).value = TODAY);

  // --- Charts Setup ---
  let charts = {};

  function initCharts() {
    charts.stepsChart = new Chart(qs('#stepsChart'), {
      type: 'line',
      data: { labels: [], datasets: [{ label: 'Steps', data: [], fill: true, tension: 0.3 }] },
      options: { responsive: true, maintainAspectRatio: false, plugins: { title: { display: true, text: 'Steps over time' } } }
    });

    charts.caloriesChart = new Chart(qs('#caloriesChart'), {
      type: 'line',
      data: { labels: [], datasets: [{ label: 'Calories', data: [], tension: 0.3 }] },
      options: { responsive: true, maintainAspectRatio: false, plugins: { title: { display: true, text: 'Calories over time' } } }
    });

    charts.moodChart = new Chart(qs('#moodChart'), {
      type: 'bar',
      data: { labels: [], datasets: [{ label: 'Mood (1â€“5)', data: [] }] },
      options: { responsive: true, maintainAspectRatio: false, scales: { y: { min: 0, max: 5 } } }
    });

    charts.nutritionPie = new Chart(qs('#nutritionPie'), {
      type: 'pie',
      data: { labels: ['Protein', 'Carbs', 'Fats', 'Other'], datasets: [{ data: [30, 50, 15, 5] }] },
      options: { responsive: true, maintainAspectRatio: false }
    });

    charts.fitnessOnly = new Chart(qs('#fitnessOnlyChart'), {
      type: 'line', data: { labels: [], datasets: [{ label: 'Steps', data: [] }] },
      options: { responsive: true, maintainAspectRatio: false }
    });

    charts.nutritionOnly = new Chart(qs('#nutritionOnlyChart'), {
      type: 'line', data: { labels: [], datasets: [{ label: 'Calories', data: [] }] },
      options: { responsive: true, maintainAspectRatio: false }
    });

    charts.mentalOnly = new Chart(qs('#mentalOnlyChart'), {
      type: 'bar', data: { labels: [], datasets: [{ label: 'Mood', data: [] }] },
      options: { responsive: true, maintainAspectRatio: false, scales: { y: { min: 0, max: 5 } } }
    });
  }

  // --- Utility ---
  const seriesFromArray = (arr) => {
    const sorted = [...arr].sort((a, b) => a.date.localeCompare(b.date));
    return { labels: sorted.map(r => r.date), values: sorted.map(r => r.value) };
  };

  // --- Render Profile ---
  function renderProfile() {
    const name = state.profile.name || 'User';
    qs('#profileName').textContent = name;
    qs('#profName').value = name;
    qs('#profAvatar').value = state.profile.avatar || '';

    const avatarEl = qs('#avatarEl');
    const preview = qs('#profileAvatarPreview');
    if (state.profile.avatar) {
      avatarEl.innerHTML = `<img src="${state.profile.avatar}" style="width:100%;height:100%;border-radius:50%;">`;
      preview.innerHTML = avatarEl.innerHTML;
    } else {
      const initial = name.charAt(0).toUpperCase();
      avatarEl.textContent = preview.textContent = initial;
    }
  }

  // --- Render Stats & Charts ---
  function renderStats() {
    const avg = (arr) => arr.length ? (arr.reduce((s, r) => s + r.value, 0) / arr.length).toFixed(1) : 0;
    const total = (arr) => arr.reduce((s, r) => s + r.value, 0);

    qs('#statAvgSteps').textContent = avg(state.fitness);
    qs('#statAvgCalories').textContent = avg(state.nutrition);
    qs('#statAvgMood').textContent = avg(state.mental);

    qs('#totalSteps').textContent = total(state.fitness);
    qs('#avgSteps').textContent = avg(state.fitness);
    qs('#totalCalories').textContent = total(state.nutrition);
    qs('#avgCalories').textContent = avg(state.nutrition);
    qs('#avgMood').textContent = avg(state.mental);

    const todaySteps = state.fitness.filter(f => f.date === TODAY).reduce((s, r) => s + r.value, 0);
    const pct = Math.min(100, Math.round((todaySteps / (state.goals.steps || 1)) * 100));
    qs('#goalFillSteps').style.width = pct + '%';
  }

  function renderCharts() {
    const sFit = seriesFromArray(state.fitness);
    const sNut = seriesFromArray(state.nutrition);
    const sMen = seriesFromArray(state.mental);

    charts.stepsChart.data.labels = sFit.labels;
    charts.stepsChart.data.datasets[0].data = sFit.values;
    charts.stepsChart.update();

    charts.caloriesChart.data.labels = sNut.labels;
    charts.caloriesChart.data.datasets[0].data = sNut.values;
    charts.caloriesChart.update();

    charts.moodChart.data.labels = sMen.labels;
    charts.moodChart.data.datasets[0].data = sMen.values;
    charts.moodChart.update();

    charts.fitnessOnly.data.labels = sFit.labels;
    charts.fitnessOnly.data.datasets[0].data = sFit.values;
    charts.fitnessOnly.update();

    charts.nutritionOnly.data.labels = sNut.labels;
    charts.nutritionOnly.data.datasets[0].data = sNut.values;
    charts.nutritionOnly.update();

    charts.mentalOnly.data.labels = sMen.labels;
    charts.mentalOnly.data.datasets[0].data = sMen.values;
    charts.mentalOnly.update();
  }

  // --- Add Entries ---
  function addEntry(type, payload) {
    if (!payload.date || isNaN(payload.value)) {
      alert('Please enter valid data');
      return;
    }
    if (type === 'fitness') state.fitness.push({ ...payload, value: Number(payload.value) });
    if (type === 'nutrition') state.nutrition.push({ ...payload, value: Number(payload.value) });
    if (type === 'mental') state.mental.push({ ...payload, value: Number(payload.value) });

    saveState();
    renderStats();
    renderCharts();
  }

  // --- Event Listeners ---
  qs('#entryAddBtn').addEventListener('click', () => {
    addEntry(qs('#entryType').value, {
      date: qs('#entryDate').value,
      value: qs('#entryValue').value,
      note: qs('#entryNote').value,
    });
    qs('#entryValue').value = '';
    qs('#entryNote').value = '';
  });

  qs('#fitAdd').addEventListener('click', () => addEntry('fitness', { date: qs('#fitDate').value, value: qs('#fitValue').value, note: qs('#fitNote').value }));
  qs('#nutAdd').addEventListener('click', () => addEntry('nutrition', { date: qs('#nutDate').value, value: qs('#nutValue').value, note: qs('#nutNote').value }));
  qs('#menAdd').addEventListener('click', () => addEntry('mental', { date: qs('#menDate').value, value: qs('#menValue').value, note: qs('#menNote').value }));

  // Clear data buttons
  qs('#fitClear').addEventListener('click', () => { if (confirm('Clear all fitness data?')) { state.fitness = []; saveState(); renderStats(); renderCharts(); } });
  qs('#nutClear').addEventListener('click', () => { if (confirm('Clear all nutrition data?')) { state.nutrition = []; saveState(); renderStats(); renderCharts(); } });
  qs('#menClear').addEventListener('click', () => { if (confirm('Clear all mental data?')) { state.mental = []; saveState(); renderStats(); renderCharts(); } });

  // Save goals/profile
  qs('#saveGoals').addEventListener('click', () => {
    state.goals = {
      steps: Number(qs('#goalSteps').value),
      calories: Number(qs('#goalCalories').value),
      mood: Number(qs('#goalMood').value)
    };
    saveState();
    alert('Goals saved successfully!');
  });

  qs('#saveProfile').addEventListener('click', () => {
    state.profile = {
      name: qs('#profName').value.trim() || 'User',
      avatar: qs('#profAvatar').value.trim(),
    };
    saveState();
    renderProfile();
    alert('Profile updated!');
  });

  // --- Navigation ---
  function showSection(key) {
    qsa('.section').forEach(s => s.classList.remove('active'));
    qs(`#section-${key}`).classList.add('active');
    qsa('.nav-link').forEach(a => a.classList.toggle('active', a.dataset.section === key));
  }
  qsa('.nav-link').forEach(a => a.addEventListener('click', e => {
    e.preventDefault();
    showSection(a.dataset.section);
  }));

  // --- Initialize App ---
  initCharts();
  renderProfile();
  renderStats();
  renderCharts();
</script>
</body>
</html>
